<!--pages/parent/home/home.wxml-->
<view class="page">
  <!-- é¡¶éƒ¨å®¶é•¿ä¿¡æ¯ -->
  <view class="header">
    <view class="parent-info">
      <image class="avatar animate-fade-in" src="{{parentInfo.avatar || '/assets/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="parent-text">
        <text class="parent-name">{{parentInfo.name || 'å®¶é•¿'}}ï¼Œæ‚¨å¥½</text>
        <text class="parent-desc">{{childInfo.name}} ä»Šå¤©è¡¨ç°å¾ˆæ£’ âœ¨</text>
      </view>
    </view>
    <view class="switch-child" bindtap="switchChild">
      <text class="switch-icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</text>
    </view>
  </view>

  <!-- å­©å­ä¿¡æ¯å¡ç‰‡ -->
  <view class="child-card animate-slide-up">
    <view class="child-header">
      <view class="child-info">
        <image class="child-avatar" src="{{childInfo.avatar || '/assets/default-avatar.png'}}" mode="aspectFill"></image>
        <view class="child-details">
          <text class="child-name">{{childInfo.name}}</text>
          <text class="child-class">{{childInfo.className}}</text>
        </view>
      </view>
      <view class="child-score-badge">
        <text class="score-label">æœ¬å‘¨è¡¨ç°</text>
        <text class="score-value">{{childInfo.weekScore}}</text>
      </view>
    </view>
    
    <view class="child-stats">
      <view class="child-stat-item" wx:for="{{childStats}}" wx:key="label">
        <text class="stat-icon">{{item.icon}}</text>
        <text class="stat-value">{{item.value}}</text>
        <text class="stat-label">{{item.label}}</text>
      </view>
    </view>
  </view>

  <!-- ä»Šæ—¥è¯„ä»· -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">ä»Šæ—¥è¯„ä»·</text>
      <text class="section-more" bindtap="viewAllEvaluations">æŸ¥çœ‹å…¨éƒ¨ â€º</text>
    </view>
    
    <view class="evaluation-card animate-slide-up" wx:if="{{todayEvaluations && todayEvaluations.length > 0}}">
      <view class="evaluation-item" wx:for="{{todayEvaluations}}" wx:key="id">
        <view class="eval-header">
          <view class="eval-course-info">
            <text class="eval-course">{{item.course}}</text>
            <text class="eval-time">{{item.time}}</text>
          </view>
          <view class="eval-score {{item.score >= 90 ? 'excellent' : item.score >= 80 ? 'good' : 'normal'}}">
            <text class="eval-score-num">{{item.score}}</text>
          </view>
        </view>
        <text class="eval-comment">{{item.comment}}</text>
        <view class="eval-footer">
          <text class="eval-teacher">{{item.teacher}} è€å¸ˆ</text>
          <text class="eval-tags" wx:if="{{item.tags}}">{{item.tags}}</text>
        </view>
      </view>
    </view>

    <view class="empty-state animate-fade-in" wx:else>
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">ä»Šå¤©è¿˜æ²¡æœ‰è¯„ä»·</text>
    </view>
  </view>

  <!-- æˆé•¿è¶‹åŠ¿ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">æˆé•¿è¶‹åŠ¿</text>
      <view class="time-tabs">
        <text class="time-tab {{trendPeriod === 'week' ? 'active' : ''}}" bindtap="changeTrendPeriod" data-period="week">å‘¨</text>
        <text class="time-tab {{trendPeriod === 'month' ? 'active' : ''}}" bindtap="changeTrendPeriod" data-period="month">æœˆ</text>
      </view>
    </view>
    
    <view class="trend-card animate-scale">
      <view class="trend-chart">
        <!-- ç®€å•çš„è¶‹åŠ¿å›¾è¡¨ç¤º -->
        <view class="chart-bars">
          <view class="chart-bar" wx:for="{{trendData}}" wx:key="date" style="height: {{item.score}}%">
            <view class="bar-fill"></view>
            <text class="bar-label">{{item.label}}</text>
          </view>
        </view>
      </view>
      <view class="trend-summary">
        <text class="trend-text">è¿‘{{trendPeriod === 'week' ? 'ä¸€å‘¨' : 'ä¸€æœˆ'}}å¹³å‡åˆ†ï¼š</text>
        <text class="trend-avg">{{averageScore}}</text>
      </view>
    </view>
  </view>

  <!-- æœ€æ–°ç…§ç‰‡ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">æœ€æ–°ç…§ç‰‡</text>
      <text class="section-more" bindtap="viewAllPhotos">æŸ¥çœ‹å…¨éƒ¨ â€º</text>
    </view>
    
    <view class="photos-grid animate-fade-in">
      <view class="photo-item" wx:for="{{recentPhotos}}" wx:key="id" bindtap="previewPhoto" data-index="{{index}}">
        <image class="photo-img" src="{{item.url}}" mode="aspectFill"></image>
        <view class="photo-info">
          <text class="photo-date">{{item.date}}</text>
        </view>
      </view>
      <view class="photo-item photo-placeholder" wx:if="{{!recentPhotos || recentPhotos.length === 0}}">
        <text class="photo-placeholder-icon">ğŸ“·</text>
      </view>
    </view>
  </view>

  <!-- å¿«æ·åŠŸèƒ½ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">å¿«æ·åŠŸèƒ½</text>
    </view>
    
    <view class="quick-actions">
      <view class="quick-btn animate-bounce" wx:for="{{quickActions}}" wx:key="action" style="animation-delay: {{index * 0.1}}s" bindtap="handleQuickAction" data-action="{{item.action}}">
        <view class="quick-icon-wrapper {{item.color}}">
          <text class="quick-icon">{{item.icon}}</text>
        </view>
        <text class="quick-label">{{item.label}}</text>
      </view>
    </view>
  </view>
</view>